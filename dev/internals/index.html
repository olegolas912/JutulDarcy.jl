<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · JutulDarcy.jl</title><meta name="title" content="Internals · JutulDarcy.jl"/><meta property="og:title" content="Internals · JutulDarcy.jl"/><meta property="twitter:title" content="Internals · JutulDarcy.jl"/><meta name="description" content="Documentation for JutulDarcy.jl."/><meta property="og:description" content="Documentation for JutulDarcy.jl."/><meta property="twitter:description" content="Documentation for JutulDarcy.jl."/><meta property="og:url" content="https://sintefmath.github.io/JutulDarcy.jl/internals/"/><meta property="twitter:url" content="https://sintefmath.github.io/JutulDarcy.jl/internals/"/><link rel="canonical" href="https://sintefmath.github.io/JutulDarcy.jl/internals/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="JutulDarcy.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">JutulDarcy.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/intro/">Getting started</a></li><li><a class="tocitem" href="../examples/two_phase_gravity_segregation/">Gravity segregation</a></li><li><a class="tocitem" href="../examples/two_phase_buckley_leverett/">Two-phase Buckley-Leverett</a></li><li><a class="tocitem" href="../examples/two_phase_unstable_gravity/">Gravity circulation with CPR preconditioner</a></li><li><a class="tocitem" href="../examples/wells_intro/">Intro to wells</a></li><li><a class="tocitem" href="../examples/five_spot_ensemble/">Quarter-five-spot with variation</a></li><li><a class="tocitem" href="../examples/co2_brine_2d_vertical/">Intro to compositional flow</a></li><li><a class="tocitem" href="../examples/compositional_5components/">Compositional with five components</a></li><li><a class="tocitem" href="../examples/optimize_simple_bl/">Parameter optimization of Buckley-Leverett</a></li><li><a class="tocitem" href="../examples/mrst_validation/">Validation of reservoir simulator</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../usage/systems/">Supported physical systems</a></li><li><a class="tocitem" href="../usage/solution/">Solving the equations</a></li></ul></li><li class="is-active"><a class="tocitem" href>Internals</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sintefmath/JutulDarcy.jl/blob/main/docs/src/internals.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.MIN_ACTIVE_WELL_RATE" href="#JutulDarcy.MIN_ACTIVE_WELL_RATE"><code>JutulDarcy.MIN_ACTIVE_WELL_RATE</code></a> — <span class="docstring-category">Constant</span></header><section><div><p>(Absolute) Minimum well rate for a well that is not disabled.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/facility.jl#L4-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.MIN_INITIAL_WELL_RATE" href="#JutulDarcy.MIN_INITIAL_WELL_RATE"><code>JutulDarcy.MIN_INITIAL_WELL_RATE</code></a> — <span class="docstring-category">Constant</span></header><section><div><p>(Absolute) Minimum initial rate for wells when controls are updated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/facility.jl#L8-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.BlackOilX-Tuple{StandardBlackOilSystem{&lt;:Any, &lt;:Any, &lt;:Any, &lt;:Any, :varswitch}, Any}" href="#JutulDarcy.BlackOilX-Tuple{StandardBlackOilSystem{&lt;:Any, &lt;:Any, &lt;:Any, &lt;:Any, :varswitch}, Any}"><code>JutulDarcy.BlackOilX</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">BlackOilX(sys::BlackOilVariableSwitchingSystem, p; sw = 0.0, so = 0.0, sg = 0.0, rs = 0.0, rv = 0.0)</code></pre><p>High level initializer for the black oil unknown degree of freedom. Will try to fill in the gaps unless system is really underspecified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/blackoil/variables/variables.jl#L73-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.CPRPreconditioner" href="#JutulDarcy.CPRPreconditioner"><code>JutulDarcy.CPRPreconditioner</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CPRPreconditioner(p = default_psolve(), s = ILUZeroPreconditioner(); strategy = :quasi_impes, weight_scaling = :unit, update_frequency = 1, update_interval = :iteration, partial_update = true)</code></pre><p>Construct a constrained pressure residual (CPR) preconditioner.</p><p>By default, this is a AMG-BILU(0) version (algebraic multigrid for pressure, block-ILU(0) for the global system).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/cpr.jl#L65-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.CPRPreconditioner" href="#JutulDarcy.CPRPreconditioner"><code>JutulDarcy.CPRPreconditioner</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Constrained pressure residual</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/cpr.jl#L43-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.DisabledControl" href="#JutulDarcy.DisabledControl"><code>JutulDarcy.DisabledControl</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DisabledControl()</code></pre><p>Control that disables a well. If a well is disabled, it is disconnected from the surface network and no flow occurs between the well and the top side. Mass transfer can still occur inside the well, and between the well and the reservoir.</p><p>See also <a href="#JutulDarcy.ProducerControl"><code>ProducerControl</code></a>, <a href="#JutulDarcy.InjectorControl"><code>InjectorControl</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L188-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.DisabledTarget" href="#JutulDarcy.DisabledTarget"><code>JutulDarcy.DisabledTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DisabledTarget(q)</code></pre><p>Disabled target used when a well is under <code>DisabledControl()</code> only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L167-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.FlowBoundaryCondition" href="#JutulDarcy.FlowBoundaryCondition"><code>JutulDarcy.FlowBoundaryCondition</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FlowBoundaryCondition(
cell,
pressure = DEFAULT_MINIMUM_PRESSURE, 
temperature = 298.15;
fractional_flow = nothing,
density = nothing,
trans_flow = 1e-12,
trans_thermal = 1e-6
)</code></pre><p>Boundary condition for constant values (pressure/temperature)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/forces/bc.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.HistoricalReservoirVoidageTarget" href="#JutulDarcy.HistoricalReservoirVoidageTarget"><code>JutulDarcy.HistoricalReservoirVoidageTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HistoricalReservoirVoidageTarget(q, weights)</code></pre><p>Historical RESV target for history matching cases.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L146-L150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.ImmiscibleSaturation" href="#JutulDarcy.ImmiscibleSaturation"><code>JutulDarcy.ImmiscibleSaturation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A single saturation that represents the &quot;other&quot; phase in a three phase compositional system where two phases are predicted by an EoS</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/multicomponent/variables/primary.jl#L70-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.ImmiscibleSystem-Tuple{Any}" href="#JutulDarcy.ImmiscibleSystem-Tuple{Any}"><code>JutulDarcy.ImmiscibleSystem</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ImmiscibleSystem(phases; reference_densities = ones(length(phases)))
ImmiscibleSystem((LiquidPhase(), VaporPhase()), (1000.0, 700.0))</code></pre><p>Set up an immiscible system for the given phases with optional reference densitites. This system is easy to specify with <a href="@ref">Pressure</a> and <a href="@ref">Saturations</a> as the default primary variables. Immiscible system assume that there is no mass transfer between phases and that a phase is uniform in composition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/types.jl#L167-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.InjectorControl" href="#JutulDarcy.InjectorControl"><code>JutulDarcy.InjectorControl</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">InjectorControl(target, mix, [density])</code></pre><p>Well control that specifies injection into the reservoir. <code>target</code> specifies the type of target and <code>mix</code> defines the injection mass fractions for all species in the model during injection. </p><p>For example, for a three-component system made up of CO2, H2O and H2, setting [0.1, 0.6, 0.3] would mean that the injection stream would contain 1 part CO2, 6 parts H2O and 3 parts H2 by mass. For an immiscible system (e.g. <code>LiquidPhase(), VaporPhase()</code>) the species corresponds to phases and [0.3, 0.7] would mean a 3 to 7 mixture of liquid and vapor by mass.</p><p>The density of the injected fluid at surface conditions is given by <code>density</code> which is defaulted to 1.0 if not given.</p><p>See also <a href="#JutulDarcy.ProducerControl"><code>ProducerControl</code></a>, <a href="#JutulDarcy.DisabledControl"><code>DisabledControl</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L218-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.MinimalTPFAGrid" href="#JutulDarcy.MinimalTPFAGrid"><code>JutulDarcy.MinimalTPFAGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MinimalTPFAGrid(ϕ, N)</code></pre><p>Generate a minimal grid suitable only for two-point flux discretization (TPFA) for given pore-volumes <code>ϕ</code> and a neighborship matrix <code>N</code> with size <code>(2, n)</code> where <code>n</code> is the number of internal faces.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/porousmedia_grids.jl#L9-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.MixedWellSegmentFlow" href="#JutulDarcy.MixedWellSegmentFlow"><code>JutulDarcy.MixedWellSegmentFlow</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Two point approximation with flux for wells</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/wells/wells.jl#L13-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.MultiPhaseCompositionalSystemLV" href="#JutulDarcy.MultiPhaseCompositionalSystemLV"><code>JutulDarcy.MultiPhaseCompositionalSystemLV</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MultiPhaseCompositionalSystemLV(equation_of_state, phases = (LiquidPhase(), VaporPhase()); reference_densities = ones(length(phases)), other_name = &quot;Water&quot;)</code></pre><p>Set up a compositional system for a given <code>equation_of_state</code> from <code>MultiComponentFlash</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/types.jl#L29-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.MultiSegmentWell-Tuple{Any, AbstractVector, Any}" href="#JutulDarcy.MultiSegmentWell-Tuple{Any, AbstractVector, Any}"><code>JutulDarcy.MultiSegmentWell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MultiSegmentWell(reservoir_cells, volumes, centers;
                N = nothing,
                name = :Well,
                perforation_cells = nothing,
                segment_models = nothing,
                segment_length = nothing,
                reference_depth = 0,
                dz = nothing,
                surface_conditions = default_surface_cond(),
                accumulator_volume = mean(volumes),
                )</code></pre><p>Create well perforated in a vector of <code>reservoir_cells</code> with corresponding <code>volumes</code> and cell <code>centers</code>.</p><p>NOTE: <code>setup_vertical_well</code> or <code>setup_well</code> are the recommended way of setting up wells.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/types.jl#L335-L353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.OverallMoleFractions-Tuple{}" href="#JutulDarcy.OverallMoleFractions-Tuple{}"><code>JutulDarcy.OverallMoleFractions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">OverallMoleFractions(;dz_max = 0.2)</code></pre><p>Overall mole fractions definition for compositional. <code>dz_max</code> is the maximum allowable change in any composition during a single Newton iteration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/multicomponent/variables/primary.jl#L24-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.Perforations" href="#JutulDarcy.Perforations"><code>JutulDarcy.Perforations</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Perforations are connections from well cells to reservoir vcells</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L39-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.PhaseMassDensities" href="#JutulDarcy.PhaseMassDensities"><code>JutulDarcy.PhaseMassDensities</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Mass density of each phase</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/variables/pvt.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.Pressure-Tuple{}" href="#JutulDarcy.Pressure-Tuple{}"><code>JutulDarcy.Pressure</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Pressure(; max_abs = nothing, max_rel = 0.2, scale = 1e8, maximum = Inf, minimum = DEFAULT_MINIMUM_PRESSURE)</code></pre><p>Pressure variable definition. <code>max_abs</code>/<code>max_rel</code> maximum allowable absolute/relative change over a Newton iteration, <code>scale</code> is a &quot;typical&quot; value used to regularize the linear system, <code>maximum</code> the largest possible value and <code>minimum</code> the smallest.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/multiphase.jl#L86-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.ProducerControl" href="#JutulDarcy.ProducerControl"><code>JutulDarcy.ProducerControl</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ProducerControl(target)</code></pre><p>Well control for production out of the reservoir. <code>target</code> specifies the type of target (for example <code>BottomHolePressureTarget()</code>).</p><p>See also <a href="#JutulDarcy.DisabledControl"><code>DisabledControl</code></a>, <a href="#JutulDarcy.InjectorControl"><code>InjectorControl</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L255-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.ReservoirRelativePermeability" href="#JutulDarcy.ReservoirRelativePermeability"><code>JutulDarcy.ReservoirRelativePermeability</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Interpolated multiphase rel. perm. that is simple (single region, no magic for more than two phases)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/variables/relperm.jl#L119-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.ReservoirVoidageTarget" href="#JutulDarcy.ReservoirVoidageTarget"><code>JutulDarcy.ReservoirVoidageTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReservoirVoidageTarget(q, weights)</code></pre><p>RESV targets with weights for each pseudo-component</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L157-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.Saturations-Tuple{}" href="#JutulDarcy.Saturations-Tuple{}"><code>JutulDarcy.Saturations</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Saturations(;ds_max = 0.2)</code></pre><p>Saturations as primary variable. <code>ds_max</code> controls maximum allowable saturation change between two Newton iterations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/multiphase.jl#L108-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.SegmentWellBoreFrictionHB" href="#JutulDarcy.SegmentWellBoreFrictionHB"><code>JutulDarcy.SegmentWellBoreFrictionHB</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Hagedorn and Brown well bore friction model for a segment.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/wells/mswells_equations.jl#L2-L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.SimpleWell-Tuple{Any}" href="#JutulDarcy.SimpleWell-Tuple{Any}"><code>JutulDarcy.SimpleWell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SimpleWell(reservoir_cells)</code></pre><p>Set up a simple well.</p><p>NOTE: <code>setup_vertical_well</code> or <code>setup_well</code> are the recommended way of setting up wells.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/types.jl#L303-L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.SinglePhaseRateTarget" href="#JutulDarcy.SinglePhaseRateTarget"><code>JutulDarcy.SinglePhaseRateTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SinglePhaseRateTarget(q, phase)</code></pre><p>Single-phase well target with value <code>q</code> specified for <code>phase</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; SinglePhaseRateTarget(0.001, LiquidPhase())
SinglePhaseRateTarget of 0.001 [m^3/s] for LiquidPhase()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L73-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.SinglePhaseSystem" href="#JutulDarcy.SinglePhaseSystem"><code>JutulDarcy.SinglePhaseSystem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SinglePhaseSystem(phase = LiquidPhase(); reference_density = 1.0)</code></pre><p>A single-phase system that only solves for pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/types.jl#L191-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.SourceTerm-Tuple{Any, Any}" href="#JutulDarcy.SourceTerm-Tuple{Any, Any}"><code>JutulDarcy.SourceTerm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SourceTerm(cell, value; fractional_flow = [1.0], type = MassSource)</code></pre><p>Create source term in given <code>cell</code> with given total <code>value</code>. The optional <code>fractional_flow</code> argument controls how this term is divided over components if used for inflow.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/forces/sources.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.StandardBlackOilSystem-Union{Tuple{}, Tuple{RV}, Tuple{RS}} where {RS, RV}" href="#JutulDarcy.StandardBlackOilSystem-Union{Tuple{}, Tuple{RV}, Tuple{RS}} where {RS, RV}"><code>JutulDarcy.StandardBlackOilSystem</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">StandardBlackOilSystem(; rs_max = nothing,
                         rv_max = nothing,
                         phases = (AqueousPhase(), LiquidPhase(), VaporPhase()),
                         reference_densities = [786.507, 1037.84, 0.969758])</code></pre><p>Set up a standard black-oil system. Keyword arguments <code>rs_max</code> and <code>rv_max</code> can either be nothing or callable objects / functions for the maximum Rs and Rv as a function of pressure. <code>phases</code> can be specified together with <code>reference_densities</code> for each phase. </p><p>NOTE: For the black-oil model, the reference densities significantly impact many aspects of the PVT behavior. These should generally be set consistently with the other properties.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/types.jl#L81-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.SurfaceGasRateTarget" href="#JutulDarcy.SurfaceGasRateTarget"><code>JutulDarcy.SurfaceGasRateTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurfaceGasRateTarget(q)</code></pre><p>Well target of specified gas rate with value <code>q</code> at surface conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L114-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.SurfaceLiquidRateTarget" href="#JutulDarcy.SurfaceLiquidRateTarget"><code>JutulDarcy.SurfaceLiquidRateTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurfaceLiquidRateTarget(q)</code></pre><p>Well target of specified liquid rate with value <code>q</code> (liquid/oil and water, but not gas) at surface conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L91-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.SurfaceOilRateTarget" href="#JutulDarcy.SurfaceOilRateTarget"><code>JutulDarcy.SurfaceOilRateTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurfaceOilRateTarget(q)</code></pre><p>Well target of specified oil rate with value <code>q</code> at surface conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L103-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.SurfaceWaterRateTarget" href="#JutulDarcy.SurfaceWaterRateTarget"><code>JutulDarcy.SurfaceWaterRateTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SurfaceWaterRateTarget(q)</code></pre><p>Well target of specified water rate with value <code>q</code> at surface conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L125-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.TabulatedRelPermSimple" href="#JutulDarcy.TabulatedRelPermSimple"><code>JutulDarcy.TabulatedRelPermSimple</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Interpolated multiphase rel. perm. that is simple (single region, no magic for more than two phases)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/variables/relperm.jl#L88-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.TotalRateTarget" href="#JutulDarcy.TotalRateTarget"><code>JutulDarcy.TotalRateTarget</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TotalRateTarget(q)</code></pre><p>Well target of specified total rate of all phases with value <code>q</code> at surface conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L136-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.component_mass_fluxes!" href="#JutulDarcy.component_mass_fluxes!"><code>JutulDarcy.component_mass_fluxes!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">component_mass_fluxes!(q, face, state, model, kgrad, upw)</code></pre><p>Implementation of component fluxes for a given system for a given face.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/flux.jl#L144-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.full_well_outputs-Tuple{Any, Any, Any}" href="#JutulDarcy.full_well_outputs-Tuple{Any, Any, Any}"><code>JutulDarcy.full_well_outputs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full_well_outputs(model, states, forces; targets = available_well_targets(model.models.Reservoir), shortname = false)</code></pre><p>Get the full set of well outputs after a simulation has occured, for plotting or other post-processing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L656-L660">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.generate_phase_indices" href="#JutulDarcy.generate_phase_indices"><code>JutulDarcy.generate_phase_indices</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_phase_indices(phases, canonical = (a = AqueousPhase(), l = LiquidPhase(), v = VaporPhase()))</code></pre><p>Generate mapping for canonical ordering of phases.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L929-L933">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.plot_reservoir_simulation_result-Tuple{MultiModel, ReservoirSimResult}" href="#JutulDarcy.plot_reservoir_simulation_result-Tuple{MultiModel, ReservoirSimResult}"><code>JutulDarcy.plot_reservoir_simulation_result</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plot_reservoir_simulation_result(model::MultiModel, res::ReservoirSimResult; wells = true, reservoir = true)</code></pre><p>Plot a reservoir simulation result. If <code>wells=true</code> well curves will be shown interactively. If <code>reservoir=true</code> the reservoir quantities will be visualized in 3D. These options can be combined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/ext.jl#L11-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.replace_target" href="#JutulDarcy.replace_target"><code>JutulDarcy.replace_target</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">replace_target(ctrl, new_target)</code></pre><p>Create new well control using <code>ctrl</code> as a template that operates under <code>new_target</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/types.jl#L204-L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.reservoir_domain-Tuple{Any}" href="#JutulDarcy.reservoir_domain-Tuple{Any}"><code>JutulDarcy.reservoir_domain</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reservoir_domain(g; permeability = convert_to_si(0.1, :darcy), porosity = 0.1, kwarg...)</code></pre><p>Set up a <code>DataDomain</code> instance for given mesh or other representation <code>g</code>. <code>permeability</code> and <code>porosity</code> are then added to the domain. If scalars are passed, they are expanded to cover all cells. Arrays are asserted to match all cells. Permeability is either one value per cell (diagonal scalar), one value per dimension given in each row (for a diagonal tensor) or a vector that represents a compact full tensor representation (6 elements in 3D, 3 in 2D).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L10-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.reservoir_domain-Tuple{JutulCase}" href="#JutulDarcy.reservoir_domain-Tuple{JutulCase}"><code>JutulDarcy.reservoir_domain</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reservoir_domain(case::JutulCase)</code></pre><p>Get reservoir domain from a reservoir simulation case.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L45-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.reservoir_domain-Tuple{Union{MultiModel, SimulationModel}}" href="#JutulDarcy.reservoir_domain-Tuple{Union{MultiModel, SimulationModel}}"><code>JutulDarcy.reservoir_domain</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reservoir_domain(m::Union{SimulationModel, MultiModel})</code></pre><p>Get reservoir domain embedded in model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.reservoir_groups_for_printing-Tuple{MultiModel}" href="#JutulDarcy.reservoir_groups_for_printing-Tuple{MultiModel}"><code>JutulDarcy.reservoir_groups_for_printing</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reservoir_groups_for_printing(model::MultiModel)</code></pre><p>Break down the standard reservoir simulator model into groups based on if they are the reservoir, wells, facility or something else.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L945-L950">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.reservoir_linsolve" href="#JutulDarcy.reservoir_linsolve"><code>JutulDarcy.reservoir_linsolve</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">reservoir_linsolve(model, precond = :cpr; &lt;keyword arguments&gt;)</code></pre><p>Set up iterative linear solver for a reservoir model from <a href="#JutulDarcy.setup_reservoir_model-Tuple{DataDomain, Any}"><code>setup_reservoir_model</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: Reservoir model that will linearize the equations for the linear solver</li><li><code>precond=:cpr</code>: Preconditioner type to use: Either :cpr (Constrained-Pressure-Residual) or :ilu0 (block-incomplete-LU) (no effect if <code>solver = :direct</code>).</li><li><code>v=0</code>: verbosity (can lead to a large amount of output)</li><li><code>solver=:bicgstab</code>: the symbol of a Krylov.jl solver (typically :gmres or :bicgstab)</li><li><code>update_interval=:once</code>: how often the CPR AMG hierarchy is reconstructed (:once, :iteration, :ministep, :step)</li><li><code>update_interval_partial=:iteration</code>: how often the pressure system is updated in CPR</li><li><code>max_coarse</code>: max size of coarse level if using AMG</li><li><code>cpr_type=nothing</code>: type of CPR (<code>:true_impes</code>, <code>:quasi_impes</code> or <code>nothing</code> for automatic)</li><li><code>partial_update=true</code>: perform partial update of CPR preconditioner outside of AMG update (see above)</li><li><code>rtol=1e-3</code>: relative tolerance for the linear solver</li><li><code>max_iterations=100</code>: limit for linear solver iterations</li></ul><p>Additional keywords are passed onto the linear solver constructor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/linsolve.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.reservoir_transmissibility-Tuple{DataDomain}" href="#JutulDarcy.reservoir_transmissibility-Tuple{DataDomain}"><code>JutulDarcy.reservoir_transmissibility</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reservoir_transmissibility(d::DataDomain)</code></pre><p>Special transmissibility function for reservoir simulation that handles additional complexity present in industry grade models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L980-L985">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.setup_reservoir_forces-Tuple{MultiModel}" href="#JutulDarcy.setup_reservoir_forces-Tuple{MultiModel}"><code>JutulDarcy.setup_reservoir_forces</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setup_reservoir_forces(model; control = nothing, limits = nothing, set_default_limits = true, &lt;keyword arguments&gt;)</code></pre><p>Set up driving forces for a reservoir model with wells</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L615-L619">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.setup_reservoir_model-Tuple{DataDomain, Any}" href="#JutulDarcy.setup_reservoir_model-Tuple{DataDomain, Any}"><code>JutulDarcy.setup_reservoir_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setup_reservoir_model(reservoir, system; wells = [], &lt;keyword arguments&gt;)
setup_reservoir_model(reservoir, system; wells = [], context = DefaultContext(), reservoir_context = nothing, backend = :csc, &lt;keyword arguments&gt;)</code></pre><p>Set up a reservoir <code>MultiModel</code> for a given reservoir <code>DataDomain</code> typically set up from  <a href="#JutulDarcy.reservoir_domain-Tuple{Any}"><code>reservoir_domain</code></a> and an optional vector of wells that are created using <a href="#JutulDarcy.setup_vertical_well-NTuple{4, Any}"><code>setup_vertical_well</code></a> and  <a href="#JutulDarcy.setup_well-Tuple{DataDomain, Any}"><code>setup_well</code></a>.</p><p>The routine automatically sets up a facility and couples the wells with the reservoir and that facility.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L55-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.setup_reservoir_simulator" href="#JutulDarcy.setup_reservoir_simulator"><code>JutulDarcy.setup_reservoir_simulator</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">setup_reservoir_simulator(models, initializer, parameters = nothing; &lt;keyword arguments&gt;)</code></pre><p><strong>Arguments</strong></p><ul><li><code>models</code>: either a single model or a Dict with the key :Reservoir for multimodels</li><li><code>initializer</code>: used to setup state0, must be compatible with <code>model</code></li><li><code>parameters</code>: initialized parameters, must be compatible with <code>model</code> if provided</li><li><code>linear_solver=:bicgstab</code>: iterative solver to use (provided model supports it)</li><li><code>precond=:cpr</code>: preconditioner for iterative solver: Either :cpr or :ilu0.</li><li><code>rtol=1e-3</code>: relative tolerance for linear solver</li><li><code>initial_dt=3600*24.0</code>: initial time-step in seconds (one day by default)</li><li><code>target_its=8</code>: target number of nonlinear iterations per time step</li><li><code>offset_its=1</code>: dampening parameter for time step selector where larger values lead to more pessimistic estimates.</li><li><code>tol_cnv=1e-3</code>: maximum allowable point-wise error (volume-balance)</li><li><code>tol_mb=1e-7</code>: maximum alllowable integrated error (mass-balance)</li><li><code>specialize=false</code>: use deep specialization of storage for faster execution, but significantly more compile time</li></ul><p>Additional keyword arguments are passed onto <a href="@ref"><code>simulator_config</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L187-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.setup_reservoir_state-Tuple{MultiModel}" href="#JutulDarcy.setup_reservoir_state-Tuple{MultiModel}"><code>JutulDarcy.setup_reservoir_state</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setup_reservoir_state(model, &lt;keyword arguments&gt;)
# Ex: For immiscible two-phase
setup_reservoir_state(model, Pressure = 1e5, Saturations = [0.2, 0.8])</code></pre><p>Convenience constructor that initializes a state for a <code>MultiModel</code> set up using <a href="#JutulDarcy.setup_reservoir_model-Tuple{DataDomain, Any}"><code>setup_reservoir_model</code></a>. The main convenience over <a href="@ref"><code>setup_state</code></a> is only the reservoir initialization values need be provided: wells are automatically initialized from the connected reservoir cells.</p><p>As an alternative to passing keyword arguments, a <code>Dict{Symbol, Any}</code> instance can be sent in as a second, non-keyword argument.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L525-L537">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.setup_vertical_well-NTuple{4, Any}" href="#JutulDarcy.setup_vertical_well-NTuple{4, Any}"><code>JutulDarcy.setup_vertical_well</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setup_vertical_well(g, K, i, j; heel = 1, toe = grid_dims_ijk(g)[3], kwarg...)</code></pre><p>Set up a vertical well for given grid <code>g</code> and permeability <code>K</code> at logical indices <code>i, j</code> perforating all cells starting at k-logical index <code>heel</code> to <code>toe</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/wells/wells.jl#L179-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.setup_vertical_well-Tuple{DataDomain, Any, Any}" href="#JutulDarcy.setup_vertical_well-Tuple{DataDomain, Any, Any}"><code>JutulDarcy.setup_vertical_well</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setup_vertical_well(D::DataDomain, i, j; &lt;kwarg&gt;)</code></pre><p>Set up a vertical well with a <code>DataDomain</code> input that represents the porous medium / reservoir where the wells it to be placed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/wells/wells.jl#L167-L172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.setup_well-Tuple{DataDomain, Any}" href="#JutulDarcy.setup_well-Tuple{DataDomain, Any}"><code>JutulDarcy.setup_well</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setup_well(D::DataDomain, reservoir_cells; skin = 0.0, Kh = nothing, radius = 0.1, dir = :z)</code></pre><p>Set up a well in <code>reservoir_cells</code> with given skin factor and radius. The order of cells matter as it is treated as a trajectory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/wells/wells.jl#L56-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.simulate_data_file-Tuple{Any}" href="#JutulDarcy.simulate_data_file-Tuple{Any}"><code>JutulDarcy.simulate_data_file</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">simulate_data_file(inp; parse_arg = NamedTuple(), kwarg...)</code></pre><p>Simulate standard input file (with extension .DATA). <code>inp</code> can either be the output from <code>setup_case_from_parsed_data</code> or a String for the path of an input file.</p><p>Additional arguments are passed onto <code>simulate_reservoir</code>. Extra inputs to the parser can be sent as a <code>parse_arg</code> <code>NamedTuple</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/input_simulation/data_input.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.simulate_mrst_case-Tuple{Any}" href="#JutulDarcy.simulate_mrst_case-Tuple{Any}"><code>JutulDarcy.simulate_mrst_case</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">simulate_mrst_case(file_name; kwarg...)</code></pre><p>Simulate a MRST case from <code>file_name</code> as exported by <code>writeJutulInput</code> in MRST.</p><p><strong>Arguments</strong></p><ul><li><code>file_name::String</code>: The path to a <code>.mat</code> file that is to be simulated.</li><li><code>extra_outputs::Vector{Symbol} = [:Saturations]</code>: Additional variables to output from the simulation.</li><li><code>write_output::Bool = true</code>: Write output (in the default JLD2 format)</li><li><code>output_path = nothing</code>: Directory for output files. Files will be written under this directory. Defaults to the folder of <code>file_name</code>.</li><li><code>write_mrst = true</code>: Write MRST compatible output after completed simulation that can be read by <code>readJutulOutput</code> in MRST.</li><li><code>backend=:csc</code>: choice of backend for linear systems. :csc for default Julia sparse, :csr for experimental parallel CSR.</li><li><code>verbose=true</code>: print some extra information specific to this routine upon calling</li><li><code>nthreads=Threads.nthreads()</code>: number of threads to use</li><li><code>linear_solver=:bicgstab</code>: name of Krylov.jl solver to use, or :direct (for small cases only)</li><li><code>info_level=0</code>: standard Jutul info_level. 0 for minimal printing, -1 for no printing, 1-5 for various levels of verbosity</li></ul><p>Additional input arguments are passed onto <a href="#JutulDarcy.setup_reservoir_simulator"><code>setup_reservoir_simulator</code></a> and <a href="@ref"><code>simulator_config</code></a> if applicable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/input_simulation/mrst_input.jl#L1182-L1200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.two_phase_compositional_mass!-NTuple{11, Any}" href="#JutulDarcy.two_phase_compositional_mass!-NTuple{11, Any}"><code>JutulDarcy.two_phase_compositional_mass!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Update total masses for two-phase compositional where another immiscible phase is present</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/multicomponent/variables/others.jl#L105-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.two_phase_compositional_mass!-Tuple{Any, Any, Nothing, Vararg{Any, 8}}" href="#JutulDarcy.two_phase_compositional_mass!-Tuple{Any, Any, Nothing, Vararg{Any, 8}}"><code>JutulDarcy.two_phase_compositional_mass!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Update total masses for two-phase compositional</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/multicomponent/variables/others.jl#L98-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.update_total_masses!" href="#JutulDarcy.update_total_masses!"><code>JutulDarcy.update_total_masses!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">update_total_masses!(totmass, tv, model, arg..., ix)</code></pre><p>Update total masses for a given system. Number of input arguments varies based on physical system under consideration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/flux.jl#L153-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.well_mismatch-NTuple{9, Any}" href="#JutulDarcy.well_mismatch-NTuple{9, Any}"><code>JutulDarcy.well_mismatch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">well_mismatch(qoi, wells, model_f, states_f, model_c, state_c, dt, step_no, forces; &lt;keyword arguments&gt;)</code></pre><p>Compute well mismatch for a set of qoi&#39;s (well targets) and a set of well symbols.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/gradients/objectives.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.well_output" href="#JutulDarcy.well_output"><code>JutulDarcy.well_output</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">well_output(model, states, well_symbol, forces, target = BottomHolePressureTarget)</code></pre><p>Get a specific well output from a valid operational target once a simulation is completed an <code>states</code> are available.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/utils.jl#L678-L682">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.well_target-Tuple{Any, BottomHolePressureTarget, Vararg{Any, 4}}" href="#JutulDarcy.well_target-Tuple{Any, BottomHolePressureTarget, Vararg{Any, 4}}"><code>JutulDarcy.well_target</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Well target contribution from well itself (bhp)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/controls.jl#L210-L212">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.well_target-Tuple{Any, DisabledTarget, Vararg{Any, 4}}" href="#JutulDarcy.well_target-Tuple{Any, DisabledTarget, Vararg{Any, 4}}"><code>JutulDarcy.well_target</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Well target contribution from well itself (disabled, zero value)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/controls.jl#L203-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.well_target-Tuple{InjectorControl, JutulDarcy.SurfaceVolumeTarget, Vararg{Any, 4}}" href="#JutulDarcy.well_target-Tuple{InjectorControl, JutulDarcy.SurfaceVolumeTarget, Vararg{Any, 4}}"><code>JutulDarcy.well_target</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Well target contribution from well itself (surface volume, injector)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/controls.jl#L217-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.well_target-Tuple{InjectorControl, TotalRateTarget, Vararg{Any, 4}}" href="#JutulDarcy.well_target-Tuple{InjectorControl, TotalRateTarget, Vararg{Any, 4}}"><code>JutulDarcy.well_target</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Well target contribution from well itself (surface volume, injector)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/controls.jl#L232-L234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.well_target-Tuple{ProducerControl, JutulDarcy.ReservoirVoidageTarget, Vararg{Any, 4}}" href="#JutulDarcy.well_target-Tuple{ProducerControl, JutulDarcy.ReservoirVoidageTarget, Vararg{Any, 4}}"><code>JutulDarcy.well_target</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Well target contribution from well itself (RESV, producer)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/controls.jl#L281-L283">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JutulDarcy.well_target-Tuple{ProducerControl, JutulDarcy.SurfaceVolumeTarget, Vararg{Any, 4}}" href="#JutulDarcy.well_target-Tuple{ProducerControl, JutulDarcy.SurfaceVolumeTarget, Vararg{Any, 4}}"><code>JutulDarcy.well_target</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Well target contribution from well itself (surface volume, producer)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sintefmath/JutulDarcy.jl/blob/073935d213bdd64071d50959ca412bb464d4853b/src/facility/controls.jl#L245-L247">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../usage/solution/">« Solving the equations</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 4 January 2024 19:08">Thursday 4 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
